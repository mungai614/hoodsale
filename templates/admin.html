<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <a class="navbar-brand" href="index.html">ClothingStore Admin</a>
  </div>
</nav>

<div class="container my-5">
  <h2 class="mb-4">Manage Products</h2>

  <!-- Product Form -->
  <form id="product-form" class="mb-5">
    <div class="row g-3">
      <div class="col-md-4">
        <input type="text" class="form-control" placeholder="Product Name" id="product-name" required>
      </div>
      <div class="col-md-2">
        <input type="number" class="form-control" placeholder="Price" id="product-price" required>
      </div>
      <div class="col-md-3">
        <input type="text" class="form-control" placeholder="Category" id="product-category" required>
      </div>
      <div class="col-md-3">
        <input type="text" class="form-control" placeholder="Image URL" id="product-image" required>
      </div>
      <div class="col-12 mt-3">
        <textarea class="form-control" placeholder="Product Description" id="product-description" rows="2" required></textarea>
      </div>
      <div class="col-12 mt-3">
        <button type="submit" class="btn btn-success">Add Product</button>
      </div>
    </div>
  </form>

  <!-- Product Table -->
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price ($)</th>
        <th>Category</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="product-table">
      <!-- Products will be listed here -->
    </tbody>
  </table>
</div>
<script>
  // Redirect if not logged in or not an admin
  const loggedInUser = JSON.parse(localStorage.getItem("loggedInUser"));

  if (!loggedInUser || loggedInUser.email !== "admin@example.com") {
    alert("Access denied. Admins only.");
    window.location.href = "login.html";
  }
</script>

<script>
  let products = JSON.parse(localStorage.getItem("products")) || [];

  function renderProducts() {
    const table = document.getElementById("product-table");
    table.innerHTML = "";

    if (products.length === 0) {
      table.innerHTML = "<tr><td colspan='5' class='text-center'>No products yet.</td></tr>";
      return;
    }

    products.forEach((product, index) => {
      table.innerHTML += `
        <tr>
          <td>${product.id}</td>
          <td>${product.name}</td>
          <td>${product.price.toFixed(2)}</td>
          <td>${product.category}</td>
          <td>
            <button class="btn btn-sm btn-danger" onclick="deleteProduct(${product.id})">Delete</button>
          </td>
        </tr>
      `;
    });
  }

  function deleteProduct(id) {
    products = products.filter(p => p.id !== id);
    localStorage.setItem("products", JSON.stringify(products));
    renderProducts();
  }

  document.getElementById("product-form").addEventListener("submit", function (e) {
    e.preventDefault();

    const product = {
      id: Date.now(), // Unique ID
      name: document.getElementById("product-name").value,
      price: parseFloat(document.getElementById("product-price").value),
      category: document.getElementById("product-category").value,
      image: document.getElementById("product-image").value,
      description: document.getElementById("product-description").value
    };

    products.push(product);
    localStorage.setItem("products", JSON.stringify(products));
    this.reset();
    renderProducts();
  });

  renderProducts();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
